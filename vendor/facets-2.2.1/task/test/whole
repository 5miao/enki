#!/usr/bin/env ratch

# Run unit tests

puts "Ruby Version: #{RUBY_VERSION}"

live = commandline.flag?('--live')

unless live
  $LOAD_PATH.unshift(File.expand_path('lib/methods'))
  $LOAD_PATH.unshift(File.expand_path('lib/core'))
  $LOAD_PATH.unshift(File.expand_path('lib/more'))
end

main :test do
  if find = commandline[0]
    unless file?(find)
      find = File.join(find, '**', 'test_*.rb')
    end
  else
    find = 'test/**/test_*.rb'
  end

  Dir.glob(find).each do |file|
    next if dir?(file)
    begin
      puts "Loading: #{file}" if $DEBUG
      load(file)
    rescue LoadError
      puts "Error loading: #{file}"
    end
  end
end

